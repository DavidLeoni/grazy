{"version": 1,"name": "shadowmapping.cgfx","samplers":{"shadowMap":{"MinFilter": 9728,"MagFilter": 9728,"WrapS": 33071,"WrapT": 33071}},"parameters":{"skinBones":{"type": "float","rows": 225,"columns": 4},"world":{"type": "float","rows": 4,"columns": 3},"viewTranspose":{"type": "float","rows": 3,"columns": 4},"shadowProjectionTranspose":{"type": "float","rows": 4,"columns": 4},"shadowDepth":{"type": "float","columns": 4},"pixelOffset":{"type": "float","columns": 2},"shadowMap":{"type": "sampler2D"}},"techniques":{"rigid":[{"parameters": ["world","viewTranspose","shadowProjectionTranspose","shadowDepth"],"semantics": ["POSITION"],"states":{"DepthTestEnable": true,"DepthFunc": 515,"DepthMask": true,"CullFaceEnable": false,"BlendEnable": false},"programs": ["vp","fp"]}],"skinned":[{"parameters": ["skinBones","world","viewTranspose","shadowProjectionTranspose","shadowDepth"],"semantics": ["POSITION","ATTR7","ATTR1"],"states":{"DepthTestEnable": true,"DepthFunc": 515,"DepthMask": true,"CullFaceEnable": false,"BlendEnable": false},"programs": ["vp_skinned","fp"]}],"blur":[{"parameters": ["pixelOffset","shadowMap"],"semantics": ["POSITION","TEXCOORD0"],"states":{"DepthTestEnable": false,"DepthMask": false,"CullFaceEnable": false,"BlendEnable": false},"programs": ["vp_blur","fp_blur"]}]},"programs":{"fp_blur":{"type": "fragment","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nvec4 _ret_0;float _TMP8;float _TMP6;float _TMP7;vec4 _TMP4;vec4 _TMP3;vec4 _TMP2;vec4 _TMP1;vec4 _TMP0;vec2 _c0017;float _TMP18;vec2 _c0023;float _TMP24;float _TMP30;vec2 _c0035;float _TMP36;vec2 _c0041;float _TMP42;float _TMP48;float _x0049;float _x0053;float _TMP58;float _x0059;float _x0063;float _TMP68;float _x0069;float _x0073;float _TMP78;float _x0079;float _x0083;float _r0087;float _rg0087;float _g0087;float _b0087;float _TMP90;float _x0097;float _x0099;uniform vec2 pixelOffset;uniform sampler2D shadowMap;void main()\n{float _accum;_c0017=tz_TexCoord[0].xy-2.0*pixelOffset;_TMP0=texture2D(shadowMap,_c0017);_TMP18=dot(_TMP0.xyz,vec3(9.68764782E-001,3.07621881E-002,4.73029679E-004));_c0023=tz_TexCoord[0].xy-pixelOffset;_TMP1=texture2D(shadowMap,_c0023);_TMP24=dot(_TMP1.xyz,vec3(9.68764782E-001,3.07621881E-002,4.73029679E-004));_TMP2=texture2D(shadowMap,tz_TexCoord[0].xy);_TMP30=dot(_TMP2.xyz,vec3(9.68764782E-001,3.07621881E-002,4.73029679E-004));_c0035=tz_TexCoord[0].xy+pixelOffset;_TMP3=texture2D(shadowMap,_c0035);_TMP36=dot(_TMP3.xyz,vec3(9.68764782E-001,3.07621881E-002,4.73029679E-004));_c0041=tz_TexCoord[0].xy+2.0*pixelOffset;_TMP4=texture2D(shadowMap,_c0041);_TMP42=dot(_TMP4.xyz,vec3(9.68764782E-001,3.07621881E-002,4.73029679E-004));_x0049=_TMP24-_TMP18;_TMP48=pow(2.71828198,_x0049);_x0053=2.00000003E-001+2.00000003E-001*_TMP48;_TMP7=log2(_x0053);_TMP6=_TMP7*6.93147182E-001;_accum=_TMP18+_TMP6;_x0059=_TMP30-_accum;_TMP58=pow(2.71828198,_x0059);_x0063=1.0+2.00000003E-001*_TMP58;_TMP7=log2(_x0063);_TMP6=_TMP7*6.93147182E-001;_accum=_accum+_TMP6;_x0069=_TMP36-_accum;_TMP68=pow(2.71828198,_x0069);_x0073=1.0+2.00000003E-001*_TMP68;_TMP7=log2(_x0073);_TMP6=_TMP7*6.93147182E-001;_accum=_accum+_TMP6;_x0079=_TMP42-_accum;_TMP78=pow(2.71828198,_x0079);_x0083=1.0+2.00000003E-001*_TMP78;_TMP7=log2(_x0083);_TMP6=_TMP7*6.93147182E-001;_accum=_accum+_TMP6;_TMP8=min(1.0,_accum);_TMP90=max(0.0,_TMP8);_x0097=_TMP90*3.19995117E+001;_r0087=floor(_x0097);_rg0087=_r0087*64.0;_x0099=_TMP90*2.04796875E+003-_rg0087;_g0087=floor(_x0099);_b0087=(_TMP90*2.11403223E+003-_r0087*6.60645142E+001)-_g0087*1.03225803;_ret_0=vec4(_r0087*3.22580636E-002,_g0087*1.58730168E-002,_b0087,1.0);gl_FragColor=_ret_0;}"},"vp_blur":{"type": "vertex","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;attribute vec4 ATTR8;\nvec4 _OUTPosition1;vec2 _OUTUV1;void main()\n{_OUTPosition1=ATTR0;_OUTUV1=ATTR8.xy;tz_TexCoord[0].xy=ATTR8.xy;gl_Position=ATTR0;}"},"fp":{"type": "fragment","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nvec4 _ret_0;float _TMP0;float _r0009;float _rg0009;float _g0009;float _b0009;float _TMP12;float _x0019;float _x0021;void main()\n{_TMP0=min(1.0,tz_TexCoord[0].x);_TMP12=max(0.0,_TMP0);_x0019=_TMP12*3.19995117E+001;_r0009=floor(_x0019);_rg0009=_r0009*64.0;_x0021=_TMP12*2.04796875E+003-_rg0009;_g0009=floor(_x0021);_b0009=(_TMP12*2.11403223E+003-_r0009*6.60645142E+001)-_g0009*1.03225803;_ret_0=vec4(_r0009*3.22580636E-002,_g0009*1.58730168E-002,_b0009,1.0);gl_FragColor=_ret_0;}"},"vp_skinned":{"type": "vertex","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;\nstruct SkinTransform{vec4 _X;vec4 _Y;vec4 _Z;};vec4 _OUTPosition1;float _OUTDepth1;vec4 _indices0010;ivec4 _Indices0010;SkinTransform _skinWeightTransform0010;attribute vec4 ATTR7;attribute vec4 ATTR1;uniform vec4 skinBones[225];uniform vec3 world[4];uniform vec4 viewTranspose[3];uniform vec4 shadowProjectionTranspose[4];uniform vec4 shadowDepth;void main()\n{vec4 _skinTempPosition;vec3 _Position;vec4 _worldPosition;vec4 _viewPosition;vec3 _TMP7;_indices0010=ATTR7*3.0;_Indices0010=ivec4(int(_indices0010.x),int(_indices0010.y),int(_indices0010.z),int(_indices0010.w));_skinWeightTransform0010._X=ATTR1.x*skinBones[_Indices0010.x];_skinWeightTransform0010._Y=ATTR1.x*skinBones[(_Indices0010.x+1)];_skinWeightTransform0010._Z=ATTR1.x*skinBones[(_Indices0010.x+2)];_skinWeightTransform0010._X=_skinWeightTransform0010._X+ATTR1.y*skinBones[_Indices0010.y];_skinWeightTransform0010._Y=_skinWeightTransform0010._Y+ATTR1.y*skinBones[(_Indices0010.y+1)];_skinWeightTransform0010._Z=_skinWeightTransform0010._Z+ATTR1.y*skinBones[(_Indices0010.y+2)];_skinWeightTransform0010._X=_skinWeightTransform0010._X+ATTR1.z*skinBones[_Indices0010.z];_skinWeightTransform0010._Y=_skinWeightTransform0010._Y+ATTR1.z*skinBones[(_Indices0010.z+1)];_skinWeightTransform0010._Z=_skinWeightTransform0010._Z+ATTR1.z*skinBones[(_Indices0010.z+2)];_skinWeightTransform0010._X=_skinWeightTransform0010._X+ATTR1.w*skinBones[_Indices0010.w];_skinWeightTransform0010._Y=_skinWeightTransform0010._Y+ATTR1.w*skinBones[(_Indices0010.w+1)];_skinWeightTransform0010._Z=_skinWeightTransform0010._Z+ATTR1.w*skinBones[(_Indices0010.w+2)];_skinTempPosition=vec4(ATTR0.x,ATTR0.y,ATTR0.z,1.0);_Position.x=dot(_skinTempPosition,_skinWeightTransform0010._X);_Position.y=dot(_skinTempPosition,_skinWeightTransform0010._Y);_Position.z=dot(_skinTempPosition,_skinWeightTransform0010._Z);_TMP7=_Position.x*world[0]+_Position.y*world[1]+_Position.z*world[2]+world[3];_worldPosition=vec4(_TMP7.x,_TMP7.y,_TMP7.z,1.0);_viewPosition.x=dot(_worldPosition,viewTranspose[0]);_viewPosition.y=dot(_worldPosition,viewTranspose[1]);_viewPosition.z=dot(_worldPosition,viewTranspose[2]);_viewPosition.w=1.0;_OUTPosition1.x=dot(_viewPosition,shadowProjectionTranspose[0]);_OUTPosition1.y=dot(_viewPosition,shadowProjectionTranspose[1]);_OUTPosition1.z=dot(_viewPosition,shadowProjectionTranspose[2]);_OUTPosition1.w=dot(_viewPosition,shadowProjectionTranspose[3]);_OUTDepth1=shadowDepth.z*_viewPosition.z+shadowDepth.w;tz_TexCoord[0].x=_OUTDepth1;gl_Position=_OUTPosition1;}"},"vp":{"type": "vertex","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;\nvec4 _OUTPosition1;float _OUTDepth1;uniform vec3 world[4];uniform vec4 viewTranspose[3];uniform vec4 shadowProjectionTranspose[4];uniform vec4 shadowDepth;void main()\n{vec4 _worldPosition;vec4 _viewPosition;vec3 _TMP7;_TMP7=ATTR0.x*world[0]+ATTR0.y*world[1]+ATTR0.z*world[2]+world[3];_worldPosition=vec4(_TMP7.x,_TMP7.y,_TMP7.z,1.0);_viewPosition.x=dot(_worldPosition,viewTranspose[0]);_viewPosition.y=dot(_worldPosition,viewTranspose[1]);_viewPosition.z=dot(_worldPosition,viewTranspose[2]);_viewPosition.w=1.0;_OUTPosition1.x=dot(_viewPosition,shadowProjectionTranspose[0]);_OUTPosition1.y=dot(_viewPosition,shadowProjectionTranspose[1]);_OUTPosition1.z=dot(_viewPosition,shadowProjectionTranspose[2]);_OUTPosition1.w=dot(_viewPosition,shadowProjectionTranspose[3]);_OUTDepth1=shadowDepth.z*_viewPosition.z+shadowDepth.w;tz_TexCoord[0].x=_OUTDepth1;gl_Position=_OUTPosition1;}"}}}